
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../base/">
      
      
      
      <link rel="icon" href="../assets/BitBurrow.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.11">
    
    
      
        <title>How to set up a BitBurrow hub - BitBurrow</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.4af4bdda.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/css/colors.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#note-this-software-does-not-exist-yet" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="BitBurrow" class="md-header__button md-logo" aria-label="BitBurrow" data-md-component="logo">
      
  <img src="../assets/BitBurrow.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            BitBurrow
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              How to set up a BitBurrow hub
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



  

<nav class="md-nav md-nav--primary md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="BitBurrow" class="md-nav__button md-logo" aria-label="BitBurrow" data-md-component="logo">
      
  <img src="../assets/BitBurrow.png" alt="logo">

    </a>
    BitBurrow
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    BitBurrow overview
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../base/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    How to set up a BitBurrow base
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    How to set up a BitBurrow hub
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    How to set up a BitBurrow hub
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#note-this-software-does-not-exist-yet" class="md-nav__link">
    <span class="md-ellipsis">
      NOTE: THIS SOFTWARE DOES NOT EXIST YET
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    <span class="md-ellipsis">
      Introduction
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#what-you-will-need" class="md-nav__link">
    <span class="md-ellipsis">
      What you will need
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#steps" class="md-nav__link">
    <span class="md-ellipsis">
      Steps
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Steps">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#acquire-a-domain-name" class="md-nav__link">
    <span class="md-ellipsis">
      Acquire a domain name
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#set-up-the-linux-server" class="md-nav__link">
    <span class="md-ellipsis">
      Set up the Linux server
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create-a-container" class="md-nav__link">
    <span class="md-ellipsis">
      Create a container
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#install-bitburrow-hub" class="md-nav__link">
    <span class="md-ellipsis">
      Install BitBurrow hub
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#forward-ports-to-the-container" class="md-nav__link">
    <span class="md-ellipsis">
      Forward ports to the container
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#make-bitburrow-hub-the-authoritative-name-server" class="md-nav__link">
    <span class="md-ellipsis">
      Make BitBurrow hub the authoritative name server
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#finish-installing-bitburrow-hub" class="md-nav__link">
    <span class="md-ellipsis">
      Finish installing BitBurrow hub
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configure-ssh-directly-to-container-optional" class="md-nav__link">
    <span class="md-ellipsis">
      Configure ssh directly to container (optional)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create-a-bitburrow-hub-administrator-account-and-coupon-code" class="md-nav__link">
    <span class="md-ellipsis">
      Create a BitBurrow hub administrator account and coupon code
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#restart-the-container-and-test" class="md-nav__link">
    <span class="md-ellipsis">
      Restart the container and test
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



  <h1>How to set up a BitBurrow hub</h1>

<h2 id="note-this-software-does-not-exist-yet">NOTE: THIS SOFTWARE DOES NOT EXIST YET</h2>
<p>Everything below is proposed draft documentation. The software to do what is described is being developed and is not at all usable yet.</p>
<h2 id="introduction">Introduction</h2>
<p>This page will help you set up a BitBurrow hub. For an introduction, see <a href="../">BitBurrow overview</a>.</p>
<h2 id="what-you-will-need">What you will need</h2>
<ol>
<li>Some background in Linux system administration and working on the command line.</li>
<li>A Linux server with a fixed, public IPv4 address, e.g. from <a href="https://www.digitalocean.com/">DigitalOcean</a>, <a href="https://www.linode.com/">Linode</a>, or other VPS provider. BitBurrow can share the server with other services so long as TCP ports 53 and 8443, and UDP port 53 are available.</li>
<li>A domain or subdomain name with the ability to host your own DNS (i.e. add an NS record for the subdomain). The nameserver service provided by some domain name registrars does not allow adding NS records for subdomains. This was true of Hover as of March, 2023. To work around this, yuu will need to use a different nameserver service, such as DigitalOcean, for the entire domain.</li>
<li>Time to manage a public server long-term.</li>
</ol>
<h2 id="steps">Steps</h2>
<h3 id="acquire-a-domain-name">Acquire a domain name</h3>
<p>Purchase your new domain name from a <a href="https://en.wikipedia.org/wiki/Domain_name_registrar">domain name registrar</a> such as <a href="https://www.hover.com/">Hover</a> or <a href="https://domains.google/">Google Domains</a>. Alternatively, create a new subdomain for an existing domain such as your company or organization. For example, if your organization owns <code>example.org</code>, you could set up <code>vxm.example.org</code> to use for BitBurrow, where <code>vxm</code> is a subdomain you choose.</p>
<p>When choosing a domain name or subdomain, it is recommended that it <em>not</em> contain <code>vpn</code>, <code>proxy</code>, <code>bitburrow</code>, <code>gateway</code>, or similar words. Public WiFi networks that restrict VPN usage may block domain names that include these. Also, choosing a name that is easy to type will make it easier for admins setting up VPN servers.</p>
<h3 id="set-up-the-linux-server">Set up the Linux server</h3>
<p>These instructions are written for Ubuntu. If you are setting up a new server, use the most recent Ubuntu LTS server image.</p>
<ol>
<li>Sign in to the Linux server, preferably as a normal user with <code>sudo</code> privileges.</li>
<li>Configure automatic security updates (<a href="https://help.ubuntu.com/community/AutomaticSecurityUpdates">more information</a>):
    <div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>sudo apt update
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>sudo apt install unattended-upgrades
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>sudo dpkg-reconfigure --priority=low unattended-upgrades  # choose Yes when prompted
</code></pre></div></li>
</ol>
<h3 id="create-a-container">Create a container</h3>
<p>This section is recommended but not required. A container helps with security by isolating BitBurrow hub from other applications running on the same server, provides a firewall from the internet, and allows the hub to run processes as root without actually being root. Additionally, to simplify the installation process below, you can run Ubuntu inside the container even if the host uses another Linux flavor.</p>
<p>After these steps, you should have a command prompt <em>in</em> the container.</p>
<ol>
<li>Install LXD:
    <div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>sudo snap install lxd
</code></pre></div></li>
<li>Initialize LXD--choose <strong>one</strong> of these lines; the first one will prompt you with options:
    <div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>lxd init
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a>lxd init --auto --storage-backend=btrfs --storage-create-loop=10
</code></pre></div></li>
<li>Create a new container and connect to it:
    <div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>VMNAME=bitburrow  # &#39;bitburrow&#39; is the name of the new container (change it if you like)
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a>lxc launch ubuntu: $VMNAME
<a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a>lxc exec $VMNAME -- sudo -u ubuntu -i  # if this fails, wait 20 seconds and try again
</code></pre></div></li>
</ol>
<h3 id="install-bitburrow-hub">Install BitBurrow hub</h3>
<p>In the commands below, replace <code>vxm.example.org</code> with your BitBurrow hub domain name and replace <code>1.2.3.4</code> with the public IP address of your BitBurrow hub host machine. At the <code>BECOME password</code> prompt (after the <code>ansible-playbook</code> command), enter your <code>sudo</code> password, or just press enter if there isn't one, which is the default for <code>lxc</code>. In most cases, the <code>ansible-playbook</code> command will fail at <code>Test BIND and DNS config</code> the first time it is run. This is normal.</p>
<ol>
<li>Download the installer (run inside container):
    <div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a>rm -f preinstall.sh
<a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a>wget https://raw.githubusercontent.com/BitBurrow/BitBurrow/main/hub_installer/preinstall.sh
<a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a>sudo bash preinstall.sh
</code></pre></div></li>
<li>Run Ansible (run inside container; remember above-mentioned replacements):
    <div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a>cd ~/hub
<a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a>ansible-playbook -i localhost, install.yaml --extra-vars &quot;domain=vxm.example.org ip=1.2.3.4&quot;
</code></pre></div></li>
<li>If the script fails with "Missing sudo password", run it again with <code>--ask-become-pass</code> before <code>install.yaml</code>.</li>
<li>If the script fails for any other reason <em>prior</em> to the <code>Test BIND and DNS config</code> step, resolve whatever caused the failure (the <code>debugging</code> tips in <code>install.yaml</code> may be useful) and rerun the above <code>ansible-playbook</code> line</li>
</ol>
<h3 id="forward-ports-to-the-container">Forward ports to the container</h3>
<p>Skip this section if you are not using a container.</p>
<ol>
<li>Type <code>exit</code> and enter to exit the container.</li>
<li>Download and run the script generated above (run on host):
    <div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a>VMNAME=bitburrow  # use the same name you used for this above
<a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a>lxc file pull $VMNAME/home/bitburrow/set_port_forwarding.sh /tmp/set_port_forwarding.sh
<a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a>/tmp/set_port_forwarding.sh
</code></pre></div></li>
<li>The above should display several lines beginning <code>Device</code></li>
<li>Connect to the container again (run on host):
    <div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a>lxc exec $VMNAME -- sudo -u ubuntu -i
</code></pre></div></li>
</ol>
<h3 id="make-bitburrow-hub-the-authoritative-name-server">Make BitBurrow hub the authoritative name server</h3>
<ol>
<li><strong>Do this only if you have a new subdomain of an existing domain for your organization or company.</strong> Configure the nameserver for <code>example.org</code> (usually done through the website of your domain name registrar) to have two additional records. Substitute <code>vxm.example.org</code> with your domain. First, add an NS record (short for name server) for <code>vxm.example.org</code> which points to <code>vxm.example.org</code>. This tells the internet that <code>vxm.example.org</code> (your BitBurrow hub) is the authoritative nameserver for all of it's subdomains, e.g. <code>foxes.vxm.example.org</code>. Use the default TTL value. Second, add an A record for <code>vxm.example.org</code> which points to the IP address of your host. This is called a "glue record" (<a href="https://en.wikipedia.org/wiki/Domain_Name_System#Circular_dependencies_and_glue_records">more info</a>). Here is a partial zone file for <code>example.org</code> which represents these two records:
    <div class="highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a>vxm.example.org. 86400 IN NS vxm.example.org.
<a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a>vxm.example.org. 3600 IN A 1.2.3.4
</code></pre></div></li>
<li><strong>Do this only if you have a domain exclusively for BitBurrow hub.</strong> Configure <code>example.org</code> (usually done through the website of your domain name registrar) to have it's NS (name server) records point to the IP address of your BitBurrow hub. This tells the internet that <code>example.org</code> (your BitBurrow hub) is the authoritative nameserver for all of it's subdomains, e.g. <code>foxes.example.org</code>.</li>
</ol>
<h3 id="finish-installing-bitburrow-hub">Finish installing BitBurrow hub</h3>
<ol>
<li>Run Ansible again (run inside container):
    <div class="highlight"><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a>cd ~/hub
<a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a>ansible-playbook -i localhost, install.yaml
</code></pre></div></li>
<li>If the script fails with "Missing sudo password", run it again with <code>--ask-become-pass</code> before <code>install.yaml</code>.</li>
<li>If the script fails for another reason, resolve whatever caused the failure (the <code>debugging</code> tips in <code>install.yaml</code> may be useful) and rerun the above <code>ansible-playbook</code> line</li>
</ol>
<h3 id="configure-ssh-directly-to-container-optional">Configure ssh directly to container (optional)</h3>
<p>In the steps below, replace <code>vxm.example.org</code> with your BitBurrow hub domain and <code>18962</code> with a port number of your choosing.</p>
<p>This assumes <code>authorized_keys</code> on the host is already configured for public-key ssh authentication.</p>
<ol>
<li>Set up ssh to container (run on host):
    <div class="highlight"><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a>VMNAME=bitburrow
<a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a>lxc exec $VMNAME -- apt install -y ssh
<a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a>cat ~/.ssh/authorized_keys |lxc exec $VMNAME -- sudo -u ubuntu bash -c &#39;cd; mkdir -p .ssh; cat - &gt;&gt; ~/.ssh/authorized_keys; chmod go-w . .ssh; chmod ugo-x,go-w .ssh/authorized_keys&#39;
<a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a>lxc config device add $VMNAME ssh proxy listen=tcp:0.0.0.0:18962 connect=tcp:127.0.0.1:22
</code></pre></div></li>
<li>On your personal computer, edit <code>~/.ssh/config</code> and add:
    <div class="highlight"><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a>Host bitburrow
<a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a>    HostName vxm.example.org
<a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a>    Port 18962
<a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a>    User ubuntu
</code></pre></div></li>
</ol>
<h3 id="create-a-bitburrow-hub-administrator-account-and-coupon-code">Create a BitBurrow hub administrator account and coupon code</h3>
<ol>
<li>Add the admin account (run inside container):
    <div class="highlight"><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a>sudo -u bitburrow /home/bitburrow/bitburrow/.venv/bin/bbhub --create-admin-account
</code></pre></div></li>
<li>Write down this login key in a safe place. It is effectively the master username and password for this BitBurrow hub.</li>
<li>Create a coupon code (run inside container):
    <div class="highlight"><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a>sudo -u bitburrow /home/bitburrow/bitburrow/.venv/bin/bbhub --create-coupon-code
</code></pre></div></li>
<li>Write down this coupon. It is what you will distribute to others to set up their own VPN server.</li>
</ol>
<h3 id="restart-the-container-and-test">Restart the container and test</h3>
<ol>
<li>Reboot (run inside the container):
    <div class="highlight"><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a>sudo reboot
</code></pre></div></li>
<li>Test a connection from the client app</li>
</ol>







  
  






                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": ["navigation.sections", "toc.integrate", "navigation.top", "search.suggest", "search.highlight", "content.tabs.link", "content.code.annotation", "content.code.copy"], "search": "../assets/javascripts/workers/search.f8cc74c7.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.c8b220af.min.js"></script>
      
    
  </body>
</html>