{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"BitBurrow overview","text":""},{"location":"#note-this-software-does-not-exist-yet","title":"NOTE: THIS SOFTWARE DOES NOT EXIST YET","text":"<p>Everything below is proposed draft documentation. The software to do what is described is being developed and is not at all usable yet.</p>"},{"location":"#introduction","title":"Introduction","text":"<p>BitBurrow is a set of tools to help you set up and use a VPN server anywhere--at your parents' house, an office, or a friend's apartment. And you don't have to be good with computers. A BitBurrow VPN server will allow you to securely use the internet from anywhere in the world as if you were at your \"VPN home\".</p> <p>If you just want to set up your own BitBurrow VPN server as described above, skip the rest of this page and go to How to set up a BitBurrow base.</p>"},{"location":"#technical-overview","title":"Technical overview","text":"<p>BitBurrow includes four main components:</p> <ul> <li>BitBurrow base is a router at your VPN home that functions as a VPN server. It accepts VPN connections from user devices and forwards them to the internet. See How to set up a BitBurrow base.</li> <li>BitBurrow app runs on Android or iOS and, together with the hub, is used to configure a BitBurrow base.</li> <li>BitBurrow hub runs on a server on the public internet. It serves to configure a BitBurrow base and also DNS requests from user devices. See How to set up a BitBurrow hub.</li> <li>BitBurrow outpost is a router configured as a VPN client, allowing users at a secondary location to use the internet as if they were at the \"VPN home\" without any additional software.</li> </ul> <p>Here is a visual representation.</p> <pre><code>%% live-view editor: https://mermaid.live/\n%% theme docs: https://mermaid.js.org/config/theming.html\n\n%% FIXME: when Material for MkDocs updates to Mermaid 10.1:\n%% * add Markdown titles, e.g.: base[\"`/fa:fa-network-wired BitBurrow **base**`\"\\]\n%% * add invisible links to attempt to order subgraphs, e.g.:: secondHome ~~~ vpnHome\n\nflowchart BT\n    %% flowchart docs: https://mermaid.js.org/syntax/flowchart.html\n    %% available icons: https://fontawesome.com/v5/search?o=r&amp;m=free\n    subgraph secondHome[\"&lt;b&gt;second home&lt;/b&gt;\"]\n        outpost[/\"&lt;img src='fa/network-wired.svg' width=16 height=16/&gt; BitBurrow &lt;b&gt;outpost&lt;/b&gt;\"\\]\n    end\n    subgraph coffeeShop[\"&lt;b&gt;coffee shop&lt;/b&gt;\"]\n        user1(\"&lt;img src='fa/laptop.svg' width=16 height=16/&gt; user device\")\n        user2(\"&lt;img src='fa/mobile-screen-button.svg' width=16 height=16/&gt; user device\")\n    end\n    subgraph vpnHome[\"&lt;b&gt;VPN home&lt;/b&gt;\"]\n        base[/\"&lt;img src='fa/network-wired.svg' width=16 height=16/&gt; BitBurrow &lt;b&gt;base&lt;/b&gt;\"\\]\n        %%click base href \"https://www.github.com\" \"BitBurrow base is ...\" _blank\n        app(\"&lt;img src='fa/mobile-screen-button.svg' width=16 height=16/&gt; BitBurrow &lt;b&gt;app&lt;/b&gt;\")\n    end\n    subgraph internet[\"&lt;b&gt;internet&lt;/b&gt;\"]\n        hub[\"&lt;img src='fa/server.svg' width=16 height=16/&gt; BitBurrow &lt;b&gt;hub&lt;/b&gt;\"]\n        resolver(&lt;img src='fa/server.svg' width=16 height=16/&gt; DNS resolver)\n        website[\"&lt;img src='fa/server.svg' width=16 height=16/&gt; website\"]\n    end\n    subgraph key[\"&lt;b&gt;key&lt;/b&gt;\"]\n        direction LR\n        A(\"&lt;img src='fa/laptop.svg' width=16 height=16/&gt;\")\n        B(\"&lt;img src='fa/server.svg' width=16 height=16/&gt;\")\n        C(\"&lt;img src='fa/laptop.svg' width=16 height=16/&gt;\")\n        D(\"&lt;img src='fa/server.svg' width=16 height=16/&gt;\")\n        E(\"&lt;img src='fa/laptop.svg' width=16 height=16/&gt;\")\n        F(\"&lt;img src='fa/server.svg' width=16 height=16/&gt;\")\n        G(\"&lt;img src='fa/laptop.svg' width=16 height=16/&gt;\")\n        H(\"&lt;img src='fa/server.svg' width=16 height=16/&gt;\")\n    end\n    %% http or https\n    A --&gt;|\"&lt;span style='background-color:#ededed'&gt;http/https&lt;/span&gt;\"| B\n    base ---&gt; website\n    base --&gt; hub\n    app &lt;--&gt; hub\n    linkStyle 0,1,2,3 stroke:purple\n    %% ssh or https\n    C --&gt;|\"&lt;span style='background-color:#ededed'&gt;ssh&lt;/span&gt;\"| D\n    app --&gt; base\n    linkStyle 4,5 stroke:red\n    %% WireGuard connections (add '=' for longer connections)\n    E ==&gt;|\"&lt;span style='background-color:#ededed'&gt;WireGuard&lt;/span&gt;\"| F\n    outpost ===&gt; base\n    user1 ===&gt; base\n    user2 ===&gt; base\n    base ===&gt; hub\n    %% DNS connections (add '.' for longer connections)\n    G -.-&gt;|\"&lt;span style='background-color:#ededed'&gt;vxm.example.org DNS&lt;/span&gt;\"| H\n    outpost -..-&gt; resolver\n    user1 -..-&gt; resolver\n    user2 -..-&gt; resolver\n    resolver -.-&gt; hub\n    %% styles\n    %%linkStyle default stroke:green\n    classDef highlight fill:#fff411,stroke-width:4px\n    %%class base highlight</code></pre>"},{"location":"#links","title":"Links","text":"<ul> <li>Source code for the BitBurrow hub</li> <li>Source code for the BitBurrow app</li> <li>Source code for this website</li> <li>BitBurrow website</li> </ul>"},{"location":"base/","title":"How to set up a BitBurrow base","text":""},{"location":"base/#note-this-software-does-not-exist-yet","title":"NOTE: THIS SOFTWARE DOES NOT EXIST YET","text":"<p>Everything below is proposed draft documentation. The software to do what is described is being developed and is not at all usable yet.</p>"},{"location":"base/#introduction","title":"Introduction","text":"<p>This page will help you set up a BitBurrow base. For an introduction, see BitBurrow overview.</p>"},{"location":"base/#what-you-will-need","title":"What you will need","text":"<ol> <li>A coupon code for a BitBurrow hub. If you do not have access to one, you can set up your own hub (this requires some computer experience) or ask your company or organization about doing this.</li> <li>A Flint router (GL.iNet GL-AX1800), available from GL.iNet and Amazon.com and WalMart and other locations.</li> <li>Permission to set up a new router at your \"VPN home\" location.</li> <li>If you plan to continue to use the existing router at your \"VPN home\", you will need the login password for this router.</li> <li>An Android phone or tablet which can be used at your \"VPN home\".</li> </ol>"},{"location":"base/#why-would-you-want-to-do-this","title":"Why would you want to do this","text":"<ol> <li>Restrictions. When you are on a commercial VPN, websites often add additional security checks or outright block service. When this happens, rarely is it clear why. A VPN via a residential or business location is not subject to these restrictions.</li> <li>Cost. Typically the cost of the VPN server hardware over its lifetime is much less than monthly VPN service fees. The existing internet connection is probably sufficient. The software is free.</li> <li>Trust. Many commercial VPN providers log VPN connections and online activities.</li> <li>Access. Banks, Netflix, and other sites will allow you to use their services as if you were at your \"VPN home\", even if you are physically in another country.</li> <li>Firewalls. WiFi at airports and coffee shops often blocks known VPN servers, but a non-commercial VPN is less likely to be blocked.</li> </ol>"},{"location":"base/#why-would-you-not-want-to-do-this","title":"Why would you not want to do this","text":"<ol> <li>Speed. Internet speed over the VPN will be limited by the devices at both ends, and also by the upload speed of the \"VPN home\" internet connection, since this will be used for downloading via the VPN.</li> <li>Reliability. If the power is out or a cable gets unplugged at the VPN server location, the VPN will be unavailable. If you depend on a VPN, have multiple options.</li> <li>Global servers. Commercial VPN providers usually have VPN servers in dozens of countries. With BitBurrow, you are limited to the servers you set up or friends invite you to use.</li> </ol>"},{"location":"base/#getting-started","title":"Getting started","text":"<ol> <li>Gather the items from the What you will need section.</li> <li>Install and run the BitBurrow app for Android on a device at the same location as the router. It is available from the Google Play Store or F-Droid.</li> </ol> <p>The BitBurrow app will walk you through the rest of the process. Here is a summary of that process.</p> <ol> <li>Scan your QR-code for the BitBurrow coupon or enter the information manually.</li> <li>You will be given a login key and be asked to write it down in a safe place.</li> <li>Plug in the new router and connect the Android device to its WiFi.</li> <li>If everything works as planned, BitBurrow will configure your router as a VPN server, prompting you if necessary. The process normally takes a few minutes.</li> <li>You can use the same BitBurrow app to add, edit, and delete VPN client devices (phones, laptops, other routers, etc.) to use the internet through your \"VPN home\" location.</li> </ol>"},{"location":"hub/","title":"How to set up a BitBurrow hub","text":""},{"location":"hub/#note-this-software-does-not-exist-yet","title":"NOTE: THIS SOFTWARE DOES NOT EXIST YET","text":"<p>Everything below is proposed draft documentation. The software to do what is described is being developed and is not at all usable yet.</p>"},{"location":"hub/#introduction","title":"Introduction","text":"<p>This page will help you set up a BitBurrow hub. For an introduction, see BitBurrow overview.</p>"},{"location":"hub/#what-you-will-need","title":"What you will need","text":"<ol> <li>Some background in Linux system administration and working on the command line.</li> <li>A Linux server with a fixed, public IPv4 address, e.g. from DigitalOcean, Linode, or other VPS provider. BitBurrow can share the server with other services so long as TCP ports 53 and 8443, and UDP port 53 are available.</li> <li>A domain or subdomain name with the ability to host your own DNS (i.e. add an NS record for the subdomain). The nameserver service provided by some domain name registrars does not allow adding NS records for subdomains. This was true of Hover as of March, 2023. To work around this, yuu will need to use a different nameserver service, such as DigitalOcean, for the entire domain.</li> <li>Time to manage a public server long-term.</li> </ol>"},{"location":"hub/#steps","title":"Steps","text":""},{"location":"hub/#acquire-a-domain-name","title":"Acquire a domain name","text":"<p>Purchase your new domain name from a domain name registrar such as Hover or Google Domains. Alternatively, create a new subdomain for an existing domain such as your company or organization. For example, if your organization owns <code>example.org</code>, you could set up <code>vxm.example.org</code> to use for BitBurrow, where <code>vxm</code> is a subdomain you choose.</p> <p>When choosing a domain name or subdomain, it is recommended that it not contain <code>vpn</code>, <code>proxy</code>, <code>bitburrow</code>, <code>gateway</code>, or similar words. Public WiFi networks that restrict VPN usage may block domain names that include these. Also, choosing a name that is easy to type will make it easier for admins setting up VPN servers.</p>"},{"location":"hub/#make-bitburrow-hub-the-authoritative-name-server","title":"Make BitBurrow hub the authoritative name server","text":"<p>In the instructions below, <code>YOUR_HUB_DOMAIN</code> is the BitBurrow hub domain name, e.g. <code>vxm.example.org</code> or <code>example.org</code>, and <code>YOUR_HUB_IP</code> is the primary public IP address of your BitBurrow hub (if you don't know, try <code>wget -q -O- api.bigdatacloud.net/data/client-ip |grep ipString |grep -Eo [0-9\\.]+</code>).</p> <ol> <li>Do this only if you have a new subdomain of an existing domain for your organization or company. Configure the nameserver for <code>YOUR_PARENT_DOMAIN</code> (e.g. <code>example.org</code>) to have two additional records. This is usually done through the website of your domain name registrar. First, add an NS record (short for name server) for <code>YOUR_HUB_DOMAIN</code> which points to <code>YOUR_HUB_DOMAIN</code>. This tells the internet that <code>YOUR_HUB_DOMAIN</code> (e.g. <code>vxm.example.org</code>) is the authoritative nameserver for all of it's subdomains, e.g. <code>foxes.vxm.example.org</code>. Use the default TTL value. Second, add an A record for <code>YOUR_HUB_DOMAIN</code> which points to the IP address of your host. This is called a \"glue record\" (more info). Here is a partial zone file for <code>example.org</code> which represents these two records:     <pre><code>vxm.example.org. 86400 IN NS vxm.example.org.\nvxm.example.org. 3600 IN A 1.2.3.4\n</code></pre></li> <li>Do this only if you have a domain exclusively for BitBurrow hub. Configure <code>example.org</code> (usually done through the website of your domain name registrar) to have it's NS (name server) records point to the IP address of your BitBurrow hub. This tells the internet that <code>example.org</code> (your BitBurrow hub) is the authoritative nameserver for all of it's subdomains, e.g. <code>foxes.example.org</code>.</li> </ol>"},{"location":"hub/#set-up-the-linux-server","title":"Set up the Linux server","text":"<p>These instructions are written for Ubuntu. If you are setting up a new server, use the most recent Ubuntu LTS server image.</p> <ol> <li>Sign in to the Linux server, preferably as a normal user with <code>sudo</code> privileges.</li> <li>Configure automatic security updates (more information):     <pre><code>sudo apt update\nsudo apt install unattended-upgrades\nsudo dpkg-reconfigure --priority=low unattended-upgrades  # choose Yes when prompted\n</code></pre></li> </ol>"},{"location":"hub/#create-a-container","title":"Create a container","text":"<p>A container helps with security by isolating BitBurrow hub from other applications running on the same server, provides a firewall from the internet, and allows the hub to run processes as root without actually being root. Additionally, to simplify the installation process below, you can run Ubuntu inside the container even if the host uses another Linux flavor.</p> <ol> <li>Install LXD:     <pre><code>sudo snap install lxd\n</code></pre></li> <li>Initialize LXD--choose one of these lines; the first one will prompt you with options:     <pre><code>lxd init\nlxd init --auto --storage-backend=btrfs --storage-create-loop=10\n</code></pre></li> <li>Create a new container and make aliases to run commands in it. To make future management easier, add these three 'alias' lines to your <code>.bashrc</code> or similar file. Replace <code>YOUR_LXC_NAME</code> with something to identify the container, e.g. <code>bitburrow</code> or your subdomain.     <pre><code>lxc launch ubuntu: YOUR_LXC_NAME\nalias bbsetup=\"lxc exec YOUR_LXC_NAME -- sudo -u ubuntu -i\"\nalias bbadmin=\"lxc exec YOUR_LXC_NAME -- sudo -u bitburrow -i\"\nalias bbhub=\"lxc exec YOUR_LXC_NAME -- sudo -u bitburrow -i /home/bitburrow/bitburrow/.venv/bin/bbhub\"\n</code></pre></li> </ol>"},{"location":"hub/#install-bitburrow-hub","title":"Install BitBurrow hub","text":"<ol> <li>Download and run the installer. If the script fails, comments within the script may be helpful. It is safe to rerun <code>bbctl</code>. If the script fails with \"Missing sudo password\", run <code>bbsetup nano bbctl</code> (substitute <code>vi</code> for <code>nano</code> if you like), insert <code>--ask-become-pass</code> after <code>ansible-playbook</code>, and run <code>bbctl</code> again.     <pre><code>bbsetup wget https://raw.githubusercontent.com/BitBurrow/BitBurrow/main/hub_installer/bbctl\nbbsetup sudo bash bbctl install YOUR_HUB_DOMAIN YOUR_HUB_IP\n</code></pre></li> <li>Configure. When editing <code>config.yaml</code>, note that the <code>help</code> section at the top is documentation; edit the data near the bottom to match your set-up.     <pre><code>bbadmin nano .config/bitburrow/config.yaml\n</code></pre></li> <li>Forward ports to the container. If the public-facing IP is not on the computer hosting the LXC, before running it, you will need to edit <code>/tmp/pfscript</code>, replace every occurrence of the public IP with the host's internet-facing IP, and forward those ports from the public-facing router.     <pre><code>bbhub port-forward-script &gt;/tmp/pfscript\nbash /tmp/pfscript\n</code></pre></li> <li>Test. Rerun this until all tests pass. The most common problem is the configuration at the domain name registrar. If possible, download a zone file and compare it to the 2-line example above.     <pre><code>bbhub test all\n</code></pre></li> </ol>"},{"location":"hub/#create-a-bitburrow-hub-administrator-account-and-coupon-code","title":"Create a BitBurrow hub administrator account and coupon code","text":"<ol> <li>Add an admin account:     <pre><code>bbhub -q create-admin-account\n</code></pre></li> <li>Write down this login key in a safe place. It is effectively the master username and password for this BitBurrow hub.</li> <li>Create a coupon code (run inside container):     <pre><code>bbhub -q create-coupon-code\n</code></pre></li> <li>Write down this coupon. It is what you will distribute to others to set up their own VPN server.</li> </ol>"},{"location":"hub/#restart-the-container-and-test","title":"Restart the container and test","text":"<ol> <li>Reboot:     <pre><code>bbsetup sudo reboot\n</code></pre></li> <li>You will probably need to configure and restart your reverse proxy service.</li> <li>Test a connection from the client app (<code>https://YOUR_HUB_DOMAIN/welcome</code>)</li> </ol>"},{"location":"hub/#upgrade-bitburrow","title":"Upgrade BitBurrow","text":"<ul> <li>Upgrade the hub and dependencies from GitHub; note that this will temporarily disrupt users who are using the server:     <pre><code>bbsetup sudo systemctl stop bitburrow\nbbsetup wget -O bbctl https://raw.githubusercontent.com/BitBurrow/BitBurrow/main/hub_installer/bbctl\nbbsetup sudo bash bbctl upgrade\nbbsetup sudo systemctl start bitburrow\n</code></pre></li> </ul>"},{"location":"hub/#notes-for-developers","title":"Notes for developers","text":"<p>The BitBurrow hub runs NiceGUI, which uses FastAPI and Uvicorn.</p>"},{"location":"hub/#set-up-steps","title":"Set-up steps","text":"<ul> <li>set up a test server via How to set up a BitBurrow hub</li> <li>(optional) fork the BitBurrow project on GitHub</li> <li>clone the repo to your local computer     <pre><code>cd /your/code/repo\nmkdir bitburrow &amp;&amp; cd $_\ngit clone https://github.com/BitBurrow/BitBurrow.git .  # or your BitBurrow fork\n</code></pre></li> <li>configure the pre-commit hooks:     <pre><code>git config core.hooksPath $(git rev-parse --show-toplevel)/git_hooks\n</code></pre></li> <li>so we can all agree on code formatting, set up Black in your code editor with the options <code>--line-length 100 --skip-string-normalization</code> (a pre-commit hook will warn you if <code>black --check ...</code> fails)</li> <li>edit code</li> </ul>"},{"location":"hub/#testing-your-changes","title":"Testing your changes","text":"<ul> <li>stop the BitBurrow hub service on your_hub (as user ubuntu or root):     <pre><code>sudo systemctl stop bitburrow\n</code></pre></li> <li>copy your modified files to <code>~/bitburrow/</code> on your_hub via something similar to:     <pre><code>rsync -av --delete --files-from &lt;(git ls-files; git ls-files --others --exclude-standard) \\\n    ./ bitburrow@your_hub:bitburrow/\n</code></pre></li> <li>reinstall:     <pre><code>cd ~/bitburrow/\npoetry install\n</code></pre></li> <li>run BitBurrow hub in debug mode:     <pre><code>bitburrow/.venv/bin/bbhub -vv serve\n</code></pre></li> </ul>"},{"location":"hub/#berror-codes","title":"Berror codes","text":"<p>A Berror code, e.g. 'B46373', is a 'B' followed by a 5-digit unique number that the user can give the developer to quickly find a line of code. Every log entry and <code>raise</code> should have one. The pre-commit hook <code>git_hooks/pre-commit</code> verifies that Berror codes are unique. Generate a new one (which is probably unique) via:</p> <pre><code>echo -n B; export LC_ALL=C; tr -dc 0-9 &lt;/dev/urandom |head -c 5; echo\n</code></pre> <p>You can also just make them up, but the above method is much less likely to generate duplicates.</p>"},{"location":"hub/#coding-conventions","title":"Coding conventions","text":"<ul> <li>Black as mentioned above</li> <li>Berror codes as mentioned above</li> <li>Use double quotes for strings that should (at some point) be translated in the UI for i18n, single quotes otherwise.</li> <li>Put methods above where they are called in the same file (where reasonable).</li> <li>Where there is embedded JavaScript, use two-space indent.</li> <li>Don't include blank lines within methods except those already mandated by Black.</li> </ul>"}]}